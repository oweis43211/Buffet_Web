<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة التحكم - البوفيه</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- شاشة التحقق -->
    <div id="authScreen" class="screen">
        <div class="login-container">
            <div class="app-header">
                <h1><i class="fas fa-cog"></i> لوحة التحكم - البوفيه</h1>
                <p>الدخول للمسؤولين فقط</p>
            </div>
            
            <div class="login-form">
                <h2><i class="fas fa-user-shield"></i> دخول المسؤول</h2>
                
                <div class="form-group">
                    <label for="adminUsername"><i class="fas fa-user"></i> اسم المستخدم:</label>
                    <input type="text" id="adminUsername" placeholder="اسم المستخدم">
                </div>
                
                <div class="form-group">
                    <label for="adminPassword"><i class="fas fa-lock"></i> كلمة المرور:</label>
                    <input type="password" id="adminPassword" placeholder="كلمة المرور">
                </div>
                
                <button id="adminLoginBtn" class="btn-primary">
                    <i class="fas fa-sign-in-alt"></i> دخول المسؤول
                </button>
                
                <button id="backToMainBtn" class="btn-secondary">
                    <i class="fas fa-arrow-left"></i> العودة للتطبيق
                </button>
                
                <div id="adminLoginMessage" class="message"></div>
            </div>
        </div>
    </div>

    <!-- لوحة التحكم الرئيسية -->
    <div id="adminPanel" class="screen hidden">
        <div class="app-container">
            <!-- شريط العنوان -->
            <header class="app-header">
                <div class="header-content">
                    <h1><i class="fas fa-cog"></i> لوحة التحكم الإدارية</h1>
                    <div class="user-info">
                        <span id="adminGreeting">مرحباً، المسؤول</span>
                        <button id="adminLogoutBtn" class="btn-logout">
                            <i class="fas fa-sign-out-alt"></i> تسجيل الخروج
                        </button>
                    </div>
                </div>
            </header>

            <!-- القائمة الجانبية -->
            <div class="admin-layout">
                <aside class="admin-sidebar">
                    <div class="sidebar-menu">
                        <button class="menu-item active" data-section="dashboard">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>لوحة التحكم</span>
                        </button>
                        
                        <button class="menu-item" data-section="products">
                            <i class="fas fa-boxes"></i>
                            <span>إدارة المنتجات</span>
                        </button>
                        
                        <button class="menu-item" data-section="users">
                            <i class="fas fa-users"></i>
                            <span>إدارة المستخدمين</span>
                        </button>
                        
                        <button class="menu-item" data-section="orders">
                            <i class="fas fa-clipboard-list"></i>
                            <span>إدارة الطلبات</span>
                        </button>
                        
                        <button class="menu-item" data-section="inventory">
                            <i class="fas fa-warehouse"></i>
                            <span>إدارة المخزون</span>
                        </button>
                        
                        <button class="menu-item" data-section="statistics">
                            <i class="fas fa-chart-bar"></i>
                            <span>الإحصائيات</span>
                        </button>
                        
                        <button class="menu-item" data-section="system">
                            <i class="fas fa-sliders-h"></i>
                            <span>إعدادات النظام</span>
                        </button>
                    </div>
                </aside>

                <!-- المحتوى الرئيسي -->
                <main class="admin-content">
                    <!-- قسم لوحة التحكم -->
                    <section id="dashboardSection" class="admin-section">
                        <h2 class="section-title"><i class="fas fa-tachometer-alt"></i> نظرة عامة</h2>
                        
                        <div class="stats-grid">
                            <div class="stat-card large">
                                <div class="stat-icon">
                                    <i class="fas fa-shopping-cart"></i>
                                </div>
                                <div class="stat-info">
                                    <h3>إجمالي الطلبات</h3>
                                    <p id="totalOrders">0</p>
                                </div>
                            </div>
                            
                            <div class="stat-card large">
                                <div class="stat-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="stat-info">
                                    <h3>عدد المستخدمين</h3>
                                    <p id="totalUsers">0</p>
                                </div>
                            </div>
                            
                            <div class="stat-card large">
                                <div class="stat-icon">
                                    <i class="fas fa-box"></i>
                                </div>
                                <div class="stat-info">
                                    <h3>عدد المنتجات</h3>
                                    <p id="totalProducts">0</p>
                                </div>
                            </div>
                            
                            <div class="stat-card large">
                                <div class="stat-icon">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <div class="stat-info">
                                    <h3>إجمالي الإيرادات</h3>
                                    <p id="totalRevenue">0 جنيه</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="recent-section">
                            <h3><i class="fas fa-clock"></i> أحدث الطلبات</h3>
                            <div id="recentOrdersTable" class="data-table">
                                <!-- سيتم تعبئتها بواسطة JavaScript -->
                            </div>
                        </div>
                    </section>

                    <!-- قسم إدارة المنتجات -->
                    <section id="productsSection" class="admin-section hidden">
                        <h2 class="section-title"><i class="fas fa-boxes"></i> إدارة المنتجات</h2>
                        
                        <div class="section-actions">
                            <button id="addProductBtn" class="btn-primary">
                                <i class="fas fa-plus"></i> إضافة منتج جديد
                            </button>
                        </div>
                        
                        <div class="data-table">
                            <table id="productsTable">
                                <thead>
                                    <tr>
                                        <th>الكود</th>
                                        <th>الصورة</th>
                                        <th>اسم المنتج</th>
                                        <th>السعر</th>
                                        <th>المخزون</th>
                                        <th>الحالة</th>
                                        <th>الإجراءات</th>
                                    </tr>
                                </thead>
                                <tbody id="productsTableBody">
                                    <!-- سيتم تعبئتها بواسطة JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </section>

                    <!-- قسم إدارة المستخدمين -->
                    <section id="usersSection" class="admin-section hidden">
                        <h2 class="section-title"><i class="fas fa-users"></i> إدارة المستخدمين</h2>
                        
                        <div class="section-actions">
                            <button id="addUserBtn" class="btn-primary">
                                <i class="fas fa-user-plus"></i> إضافة مستخدم جديد
                            </button>
                        </div>
                        
                        <div class="data-table">
                            <table id="usersTable">
                                <thead>
                                    <tr>
                                        <th>اسم المستخدم</th>
                                        <th>كلمة المرور</th>
                                        <th>عدد الطلبات</th>
                                        <th>إجمالي المشتريات</th>
                                        <th>الإجراءات</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody">
                                    <!-- سيتم تعبئتها بواسطة JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </section>

                    <!-- قسم إدارة الطلبات -->
                    <section id="ordersSection" class="admin-section hidden">
                        <h2 class="section-title"><i class="fas fa-clipboard-list"></i> إدارة الطلبات</h2>
                        
                        <div class="filters-row">
                            <select id="orderStatusFilter">
                                <option value="">كل الحالات</option>
                                <option value="في الانتظار">في الانتظار</option>
                                <option value="تم الاستلام">تم الاستلام</option>
                                <option value="جاري التجهيز">جاري التجهيز</option>
                                <option value="تم التسليم">تم التسليم</option>
                                <option value="ملغي">ملغي</option>
                            </select>
                            
                            <input type="date" id="orderDateFilter">
                            
                            <button id="refreshOrdersBtn" class="btn-secondary">
                                <i class="fas fa-sync"></i> تحديث
                            </button>
                        </div>
                        
                        <div class="data-table">
                            <table id="ordersTable">
                                <thead>
                                    <tr>
                                        <th>رقم الطلب</th>
                                        <th>المستخدم</th>
                                        <th>التاريخ</th>
                                        <th>المنتجات</th>
                                        <th>الإجمالي</th>
                                        <th>الحالة</th>
                                        <th>الإجراءات</th>
                                    </tr>
                                </thead>
                                <tbody id="adminOrdersTableBody">
                                    <!-- سيتم تعبئتها بواسطة JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </section>

                    <!-- قسم إدارة المخزون -->
                    <section id="inventorySection" class="admin-section hidden">
                        <h2 class="section-title"><i class="fas fa-warehouse"></i> إدارة المخزون</h2>
                        
                        <div class="inventory-summary">
                            <div class="summary-card">
                                <h3>المنتجات المتاحة</h3>
                                <p id="availableProductsCount">0</p>
                            </div>
                            <div class="summary-card">
                                <h3>المنتجات الناقصة</h3>
                                <p id="lowStockCount">0</p>
                            </div>
                            <div class="summary-card">
                                <h3>المنتجات غير المتاحة</h3>
                                <p id="unavailableProductsCount">0</p>
                            </div>
                        </div>
                        
                        <div class="data-table">
                            <table id="inventoryTable">
                                <thead>
                                    <tr>
                                        <th>الكود</th>
                                        <th>اسم المنتج</th>
                                        <th>المخزون الحالي</th>
                                        <th>الحد الأدنى</th>
                                        <th>الحالة</th>
                                        <th>تحديث المخزون</th>
                                    </tr>
                                </thead>
                                <tbody id="inventoryTableBody">
                                    <!-- سيتم تعبئتها بواسطة JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </section>

                    <!-- قسم الإحصائيات -->
                    <section id="statisticsSection" class="admin-section hidden">
                        <h2 class="section-title"><i class="fas fa-chart-bar"></i> الإحصائيات والتقارير</h2>
                        
                        <div class="stats-filters">
                            <select id="statsPeriod">
                                <option value="today">اليوم</option>
                                <option value="week">أسبوع</option>
                                <option value="month">شهر</option>
                                <option value="year">سنة</option>
                                <option value="all">كل الفترات</option>
                            </select>
                            
                            <input type="date" id="statsFromDate">
                            <input type="date" id="statsToDate">
                            
                            <button id="generateReportBtn" class="btn-primary">
                                <i class="fas fa-chart-line"></i> توليد التقرير
                            </button>
                        </div>
                        
                        <div class="charts-grid">
                            <div class="chart-container">
                                <h3>الإيرادات اليومية</h3>
                                <canvas id="revenueChart"></canvas>
                            </div>
                            
                            <div class="chart-container">
                                <h3>توزيع المبيعات</h3>
                                <canvas id="salesChart"></canvas>
                            </div>
                        </div>
                        
                        <div class="top-section">
                            <div class="top-products">
                                <h3>أكثر المنتجات مبيعاً</h3>
                                <div id="topProductsList" class="top-list">
                                    <!-- سيتم تعبئتها بواسطة JavaScript -->
                                </div>
                            </div>
                            
                            <div class="top-users">
                                <h3>أكثر المستخدمين شراءً</h3>
                                <div id="topUsersList" class="top-list">
                                    <!-- سيتم تعبئتها بواسطة JavaScript -->
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- قسم إعدادات النظام -->
                    <section id="systemSection" class="admin-section hidden">
                        <h2 class="section-title"><i class="fas fa-sliders-h"></i> إعدادات النظام</h2>
                        
                        <div class="settings-cards">
                            <div class="setting-card">
                                <h3><i class="fas fa-store"></i> حالة البوفيه</h3>
                                <div class="setting-control">
                                    <label class="switch">
                                        <input type="checkbox" id="buffetToggle">
                                        <span class="slider"></span>
                                    </label>
                                    <span id="buffetStatusText">مفتوح</span>
                                </div>
                                <p class="setting-description">
                                    فتح/إغلاق النظام للطلبات
                                </p>
                            </div>
                            
                            <div class="setting-card">
                                <h3><i class="fas fa-moon"></i> وقت الصلاة</h3>
                                <div class="setting-control">
                                    <label class="switch">
                                        <input type="checkbox" id="prayerToggle">
                                        <span class="slider"></span>
                                    </label>
                                    <span id="prayerStatusText">متوقف</span>
                                </div>
                                <p class="setting-description">
                                    إيقاف النظام أثناء الصلاة
                                </p>
                            </div>
                            
                            <div class="setting-card">
                                <h3><i class="fas fa-bell"></i> الإشعارات</h3>
                                <div class="setting-control">
                                    <label class="switch">
                                        <input type="checkbox" id="notificationsToggle" checked>
                                        <span class="slider"></span>
                                    </label>
                                    <span>مفعلة</span>
                                </div>
                                <p class="setting-description">
                                    إشعارات الطلبات الجديدة
                                </p>
                            </div>
                        </div>
                        
                        <div class="backup-section">
                            <h3><i class="fas fa-database"></i> نسخ احتياطي</h3>
                            <div class="backup-actions">
                                <button id="backupBtn" class="btn-primary">
                                    <i class="fas fa-download"></i> إنشاء نسخة احتياطية
                                </button>
                                <button id="restoreBtn" class="btn-secondary">
                                    <i class="fas fa-upload"></i> استعادة نسخة
                                </button>
                            </div>
                        </div>
                    </section>
                </main>
            </div>
        </div>
    </div>

    <!-- نماذج منبثقة -->
    <div id="productModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="productModalTitle">إضافة منتج جديد</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="productForm">
                    <div class="form-group">
                        <label for="productCode">كود المنتج:</label>
                        <input type="number" id="productCode" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="productName">اسم المنتج:</label>
                        <input type="text" id="productName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="productPrice">السعر (جنيه):</label>
                        <input type="number" id="productPrice" step="0.01" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="productCategory">الفئة:</label>
                        <select id="productCategory">
                            <option value="drinks">مشروبات</option>
                            <option value="foods">مأكولات</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="productImage">رابط الصورة:</label>
                        <input type="text" id="productImage" placeholder="https://example.com/image.jpg">
                    </div>
                    
                    <div class="form-group">
                        <label for="initialStock">المخزون الأولي:</label>
                        <input type="number" id="initialStock" value="10" min="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="productStatus">الحالة:</label>
                        <select id="productStatus">
                            <option value="active">متاح</option>
                            <option value="inactive">غير متاح</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary close-modal">إلغاء</button>
                <button type="submit" form="productForm" class="btn-primary" id="saveProductBtn">
                    <i class="fas fa-save"></i> حفظ
                </button>
            </div>
        </div>
    </div>

    <div id="userModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="userModalTitle">إضافة مستخدم جديد</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="userForm">
                    <div class="form-group">
                        <label for="newUsername">اسم المستخدم:</label>
                        <input type="text" id="newUsername" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="newPassword">كلمة المرور (4 أرقام):</label>
                        <input type="password" id="newPassword" maxlength="4" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="confirmNewPassword">تأكيد كلمة المرور:</label>
                        <input type="password" id="confirmNewPassword" maxlength="4" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary close-modal">إلغاء</button>
                <button type="submit" form="userForm" class="btn-primary" id="saveUserBtn">
                    <i class="fas fa-save"></i> حفظ
                </button>
            </div>
        </div>
    </div>

    <div id="orderDetailsModal" class="modal hidden">
        <div class="modal-content wide-modal">
            <div class="modal-header">
                <h2>تفاصيل الطلب</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="orderDetailsContent">
                    <!-- سيتم تعبئتها بواسطة JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- إشعارات -->
    <div id="notificationArea" class="notification-area"></div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="admin.js"></script>
</body>
</html>
